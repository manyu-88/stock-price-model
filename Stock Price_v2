{"cells":[{"cell_type":"code","source":["from google.colab import drive\n","drive.mount('/content/drive')\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"5UTMFBeOWNKp","executionInfo":{"status":"ok","timestamp":1763816481040,"user_tz":-420,"elapsed":4930,"user":{"displayName":"Abhimanyu","userId":"02570476676756296416"}},"outputId":"78751b76-d2ee-4c1f-d93c-839c1ce37b32"},"execution_count":19,"outputs":[{"output_type":"stream","name":"stdout","text":["Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount(\"/content/drive\", force_remount=True).\n"]}]},{"cell_type":"code","source":["import os\n","from getpass import getpass\n","\n","# üîπ Your ML project folder (EXACT PATH)\n","project_path = \"/content/drive/MyDrive/Project\" # your path\n","os.chdir(project_path)\n","\n","print(\"Working directory:\", os.getcwd())\n","!ls\n","\n","# # üîπ Initialize Git (safe to run even if repo already exists)\n","# !git init\n","\n","# # üîπ Git user identity\n","# !git config --global user.name \"manyu-88\"\n","# !git config --global user.email \"abhimanyu_shirwalkar2015@pgp.isb.edu\"\n","\n","# # üîπ Ensure main branch\n","# !git branch -M main\n","\n","# üîπ GitHub repo config (EXACT FOR YOU)\n","username = \"manyu-88\"\n","repo_name = \"stock-price-model\" # your repo\n","\n","# # üîπ Ask for GitHub Personal Access Token secretly\n","token = getpass(\"Enter your GitHub Personal Access Token: \")\n","\n","# üîπ Set remote origin (replace if exists)\n","remote_url = f\"https://{token}@github.com/{username}/{repo_name}.git\"\n","!git remote remove origin 2>/dev/null || true\n","!git remote add origin $remote_url\n","\n","\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"rnU3-1j9TNG_","executionInfo":{"status":"ok","timestamp":1763816502126,"user_tz":-420,"elapsed":21097,"user":{"displayName":"Abhimanyu","userId":"02570476676756296416"}},"outputId":"f4276d01-3e5d-40a0-ac41-96f7a4558c3d"},"execution_count":20,"outputs":[{"name":"stdout","output_type":"stream","text":["Working directory: /content/drive/MyDrive/Project\n"," output.xlsx  'Stock Price_v2'\n","Enter your GitHub Personal Access Token: ¬∑¬∑¬∑¬∑¬∑¬∑¬∑¬∑¬∑¬∑\n"]}]},{"cell_type":"code","source":["# üîπ Add and commit everything\n","!git add .\n","!git commit -m \"First Run for Stock Price Prediction ML project w Basic RF\"\n","\n","# üîπ Push to GitHub\n","# !git push -u origin main\n","!git push -u origin main --force"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"oCK9IyovXyGw","executionInfo":{"status":"ok","timestamp":1763816504698,"user_tz":-420,"elapsed":2573,"user":{"displayName":"Abhimanyu","userId":"02570476676756296416"}},"outputId":"a3a6d19d-eafb-436f-ab88-3a2be2b0785d"},"execution_count":21,"outputs":[{"output_type":"stream","name":"stdout","text":["Author identity unknown\n","\n","*** Please tell me who you are.\n","\n","Run\n","\n","  git config --global user.email \"you@example.com\"\n","  git config --global user.name \"Your Name\"\n","\n","to set your account's default identity.\n","Omit --global to set the identity only in this repository.\n","\n","fatal: unable to auto-detect email address (got 'root@cc1d4f169007.(none)')\n","Branch 'main' set up to track remote branch 'main' from 'origin'.\n","Everything up-to-date\n"]}]},{"cell_type":"code","execution_count":22,"metadata":{"executionInfo":{"elapsed":11476,"status":"ok","timestamp":1763816516178,"user":{"displayName":"Abhimanyu","userId":"02570476676756296416"},"user_tz":-420},"id":"jOKOBZlwN1a5","colab":{"base_uri":"https://localhost:8080/"},"outputId":"98e7c82f-fe60-476e-f41e-bf80c344d32e"},"outputs":[{"output_type":"stream","name":"stdout","text":["Requirement already satisfied: schedule in /usr/local/lib/python3.12/dist-packages (1.2.2)\n","Requirement already satisfied: requests in /usr/local/lib/python3.12/dist-packages (2.32.4)\n","Requirement already satisfied: charset_normalizer<4,>=2 in /usr/local/lib/python3.12/dist-packages (from requests) (3.4.4)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.12/dist-packages (from requests) (3.11)\n","Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.12/dist-packages (from requests) (2.5.0)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.12/dist-packages (from requests) (2025.11.12)\n"]}],"source":["!pip install schedule\n","!pip install requests"]},{"cell_type":"code","execution_count":23,"metadata":{"id":"EIKTsRpDOIVB","executionInfo":{"status":"ok","timestamp":1763816516191,"user_tz":-420,"elapsed":8,"user":{"displayName":"Abhimanyu","userId":"02570476676756296416"}}},"outputs":[],"source":["import time\n","import requests\n","import pandas as pd\n","from datetime import datetime,timedelta\n","import schedule\n","import pytz\n","import csv\n","import yfinance as yf"]},{"cell_type":"code","execution_count":24,"metadata":{"id":"ex1Vd4LPOQU2","executionInfo":{"status":"ok","timestamp":1763816516194,"user_tz":-420,"elapsed":7,"user":{"displayName":"Abhimanyu","userId":"02570476676756296416"}}},"outputs":[],"source":["import time\n","import requests\n","import pandas as pd\n","from datetime import datetime, timedelta\n","import schedule\n","import pytz\n","import csv\n","import yfinance as yf\n","from sklearn.model_selection import GridSearchCV\n","from sklearn.ensemble import RandomForestRegressor\n","\n","# üõ†Ô∏è FIX: Import for the downstream error 'train_test_split is not defined'\n","from sklearn.model_selection import train_test_split\n","\n","class TickerInfo:\n","    \"\"\"Class to hold the prediction results for each stock.\"\"\"\n","    def __init__(self, name, score, delta):\n","        self.name = name\n","        self.score = score\n","        self.delta = delta\n","\n","class StockAPI():\n","    \"\"\"Handles data retrieval from yfinance.\"\"\"\n","\n","    def __init__(self):\n","        # Set a realistic historical date range (e.g., 2 years ending in mid-2025)\n","        self.date_end = datetime(2025, 11, 15)\n","        # Calculate start date ~2 years back, adjusting for trading days\n","        self.date_start = self.date_end - timedelta(days=2 * 365 + 10)\n","\n","        # Fetch bond data once upon initialization\n","        self.closing_yield = self._fetch_yield_data()\n","        print(\"Bond Yield data fetched successfully and stored.\")\n","\n","    def _fetch_yield_data(self):\n","        \"\"\"\n","        Fetches 5Y and 10Y T-Bond yield data once using yfinance.\n","        Guarantees return of an indexed DataFrame (or an empty one).\n","        \"\"\"\n","        end_date_str = self.date_end.strftime(\"%Y-%m-%d\")\n","        start_date_str = self.date_start.strftime(\"%Y-%m-%d\")\n","\n","        # Default empty DataFrame to return on failure\n","        empty_df = pd.DataFrame({'from': pd.Series([], dtype='datetime64[ns]'),\n","                                 '5Y_close': [],\n","                                 '10Y_close': []})\n","        try:\n","            # Setting progress=False to suppress output during download\n","            # Added auto_adjust=False to suppress FutureWarning\n","            tbond_5y = yf.download(tickers=\"^FVX\", start=start_date_str, end=end_date_str, progress=False, auto_adjust=False)\n","            tbond_10y = yf.download(tickers=\"^TNX\", start=start_date_str, end=end_date_str, progress=False, auto_adjust=False)\n","\n","            # Robustly handle potential MultiIndex in bond data (Fix 2)\n","            if isinstance(tbond_5y.columns, pd.MultiIndex):\n","                tbond_5y.columns = tbond_5y.columns.get_level_values(0)\n","            if isinstance(tbond_10y.columns, pd.MultiIndex):\n","                tbond_10y.columns = tbond_10y.columns.get_level_values(0)\n","\n","            # Reset index to move 'Date' from index to a column for merging\n","            tbond_5y = tbond_5y.reset_index()\n","            tbond_10y = tbond_10y.reset_index()\n","\n","        except Exception as e:\n","            print(f\"Error during yfinance download for bonds: {e}\")\n","            return empty_df\n","\n","        # Robust check for valid time-series data\n","        has_5y_data = 'Close' in tbond_5y.columns and len(tbond_5y) > 1\n","        has_10y_data = 'Close' in tbond_10y.columns and len(tbond_10y) > 1\n","\n","        if not has_5y_data or not has_10y_data:\n","            print(\"WARNING: Bond data is incomplete or empty. Returning empty DataFrame.\")\n","            return empty_df\n","\n","        try:\n","            # Select the Date and Close columns and rename the Close columns\n","            df_5y = tbond_5y[['Date', 'Close']].rename(columns={'Close': '5Y_close'})\n","            df_10y = tbond_10y[['Date', 'Close']].rename(columns={'Close': '10Y_close'})\n","\n","            # Use pd.merge to combine the two dataframes on the common 'Date' column\n","            closing_yield = pd.merge(df_5y, df_10y, on='Date', how='inner')\n","\n","            # Rename the 'Date' column to 'from' to match the stock data format\n","            closing_yield = closing_yield.rename(columns={'Date': 'from'})\n","\n","            # üõ†Ô∏è FIX: Update fillna syntax to suppress FutureWarning\n","            closing_yield['5Y_close'] = closing_yield['5Y_close'].ffill()\n","            closing_yield['10Y_close'] = closing_yield['10Y_close'].ffill()\n","\n","            return closing_yield\n","\n","        except Exception as e:\n","            # Catch errors during processing\n","            print(f\"Error processing bond data after download: {e}\")\n","            return empty_df\n","\n","    def update_stock_data(self, ticker):\n","\n","        start_date_str = self.date_start.strftime(\"%Y-%m-%d\")\n","        end_date_str = self.date_end.strftime(\"%Y-%m-%d\")\n","\n","        # 1. Fetch historical OHLCV data for the entire range using yfinance\n","        try:\n","            df = yf.download(ticker, start=start_date_str, end=end_date_str, progress=False, auto_adjust=False)\n","\n","            if isinstance(df.columns, pd.MultiIndex):\n","                # Dropping the second level (the ticker symbol) from the MultiIndex\n","                df.columns = df.columns.droplevel(1)\n","\n","            # Move Date index to 'from' column\n","            df = df.reset_index().rename(columns={'Date': 'from'})\n","\n","        except Exception as e:\n","            print(f\"Error downloading stock data for {ticker}: {e}\")\n","            return pd.DataFrame()\n","\n","        if df.empty:\n","            print(f\"Skipping {ticker}: No historical stock data retrieved.\")\n","            return pd.DataFrame()\n","\n","        # 2. Fetch EPS/PE (Fundamentals)\n","        try:\n","            stock_info = yf.Ticker(ticker).info\n","            stock_eps = stock_info.get('trailingEps', None)\n","\n","            # Use a robust check for EPS\n","            if stock_eps is None or stock_eps == 0:\n","                print(f\"WARNING: EPS not valid for {ticker}. Skipping.\")\n","                return pd.DataFrame()\n","\n","            # 3. Calculate PE and add fundamental features\n","            df['EPS'] = stock_eps\n","            # Calculate PE ratio\n","            df['PE'] = df['Close'] / df['EPS']\n","\n","            # Add other required columns for the rest of the code to work\n","            df['status'] = 'OK'\n","            df['symbol'] = ticker\n","\n","        except Exception as e:\n","            print(f\"Error fetching fundamental data for {ticker}: {e}\")\n","            return pd.DataFrame()\n","\n","        # 4. Merge with bond yield data\n","        df = df.merge(self.closing_yield, how='left', on='from')\n","\n","        # üõ†Ô∏è FIX: Update fillna syntax to suppress FutureWarning\n","        df['5Y_close'] = df['5Y_close'].ffill()\n","        df['10Y_close'] = df['10Y_close'].ffill()\n","\n","        # Rename columns to match the desired format\n","        df.rename(columns={'Open': 'open', 'High': 'high', 'Low': 'low', 'Close': 'close', 'Volume': 'volume'}, inplace=True)\n","\n","        return df\n","\n","# Note: The 'Skipping X due to an unexpected error: name train_test_split is not defined'\n","# will now be resolved by the addition of 'from sklearn.model_selection import train_test_split'\n","# at the top of the combined script."]},{"cell_type":"code","source":["stock_output=[]\n","data_raw=StockAPI()\n","\n","stock_basket=['AMZN','AAPL','GOOG','NDAQ','META','TSLA','INTC','AMD']\n","\n","for ticker in stock_basket:\n","    print(f\"\\n--- Processing {ticker} ---\")\n","    try:\n","        # Get historical stock and combined bond data\n","        df = data_raw.update_stock_data(ticker)\n","        print(\"ok\")\n","        print(df)\n","\n","        # --- Data Validation ---\n","        # The column names are now lowercased: 'open', 'close'\n","        if df.empty or len(df) < 31:\n","            print(f\"Skipping {ticker}: DataFrame is empty or too short.\")\n","            continue\n","\n","        # --- Data Preprocessing ---\n","        print(f\"Data retrieved: {len(df)} rows\")\n","\n","        # Drop columns and create target variable\n","        df = df.drop(columns=['status','EPS','symbol'])\n","        df['pred30d'] = df['open'].shift(-30) # Uses 'open' which is now lowercase\n","\n","        # Create temporal features\n","        df['day_of_week'] = pd.to_datetime(df['from']).dt.dayofweek + 1\n","        df['month'] = pd.to_datetime(df['from']).dt.month\n","        df = df.drop(columns=['from'])\n","\n","        # Reorder columns (pop/insert)\n","        df.insert(loc=0, column=\"day_of_week\", value=df.pop(\"day_of_week\"))\n","        df.insert(loc=0, column=\"month\", value=df.pop(\"month\"))\n","\n","        # Drop NaNs\n","        df = df.dropna(subset=['pred30d', '5Y_close', '10Y_close'])\n","\n","        # Convert temporal features to categorical\n","        new_format=[\"month\",\"day_of_week\"]\n","        for x in new_format:\n","            df[x] = df[x].astype(\"category\")\n","\n","        # --- Model Training ---\n","        X = df.iloc[:,:-1]\n","        X = pd.get_dummies(X)\n","        y = df['pred30d']\n","\n","        if X.shape[0] < 2:\n","            print(f\"Skipping {ticker}: Not enough data left for train/test split after dropping NaNs.\")\n","            continue\n","\n","        X_train,X_test,y_train,y_test = train_test_split(X,y,test_size=0.2,random_state=42)\n","\n","        # Hyperparameter tuning with GridSearchCV\n","        parameters = {'n_estimators':[10, 25], 'criterion':['absolute_error', 'squared_error']}\n","        rf_gs = GridSearchCV(RandomForestRegressor(random_state=42), parameters, cv=5, n_jobs=-1, verbose=0)\n","        rf_gs = rf_gs.fit(X_train,y_train)\n","\n","        model_score = rf_gs.score(X_test,y_test)\n","\n","        # --- Prediction on Current Data ---\n","        current_data = df.tail(1).copy()\n","        current_data_processed = pd.get_dummies(current_data)\n","\n","        if \"pred30d\" in current_data_processed.columns:\n","            current_data_processed = current_data_processed.drop(columns=[\"pred30d\"])\n","\n","        # Align columns of the single-row prediction data with the training data (X)\n","        current_data_aligned = current_data_processed.reindex(columns=X.columns, fill_value=0)\n","\n","        # Predict\n","        stock_30dpred = rf_gs.predict(current_data_aligned)\n","\n","        # Calculate delta\n","        current_close = current_data[\"close\"].values[0] # Uses 'close' which is now lowercase\n","        delta_pred = stock_30dpred[0] / current_close\n","\n","        print(f\"Prediction for {ticker}: Delta={delta_pred:.4f}, Pred={stock_30dpred[0]:.2f}, Close={current_close:.2f}\")\n","\n","        stock=TickerInfo(ticker, model_score, delta_pred)\n","        stock_output.append(stock)\n","\n","    except ValueError as e:\n","        print(f\"Skipping {ticker} due to a processing ValueError: {e}\")\n","    except Exception as e:\n","        print(f\"Skipping {ticker} due to an unexpected error: {e}\")\n","\n","\n","# --- 3. Final Output ---\n","stock_info_df=pd.DataFrame(columns=[\"stock\",\"model score\",\"delta pred\"])\n","stock_info_df[\"stock\"]=[ticker.name for ticker in stock_output]\n","stock_info_df[\"model score\"]=[ticker.score for ticker in stock_output]\n","stock_info_df[\"delta pred\"]=[ticker.delta for ticker in stock_output]\n","stock_info_df.to_excel(\"/content/drive/MyDrive/Project/output.xlsx\", index=False,)\n","\n","print(\"\\n--- Execution Complete ---\")\n","print(f\"Results saved to output.xlsx for {len(stock_output)} tickers.\")"],"metadata":{"id":"7CP_Zj0PGQZy","executionInfo":{"status":"ok","timestamp":1763816559083,"user_tz":-420,"elapsed":42887,"user":{"displayName":"Abhimanyu","userId":"02570476676756296416"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"60474faa-a3ef-4af3-a257-391f2ac7deb8"},"execution_count":25,"outputs":[{"output_type":"stream","name":"stdout","text":["Bond Yield data fetched successfully and stored.\n","\n","--- Processing AMZN ---\n","ok\n","Price       from   Adj Close       close        high         low        open  \\\n","0     2023-11-06  139.740005  139.740005  140.729996  138.360001  138.759995   \n","1     2023-11-07  142.710007  142.710007  143.369995  140.500000  140.550003   \n","2     2023-11-08  142.080002  142.080002  143.119995  141.220001  142.970001   \n","3     2023-11-09  140.600006  140.600006  142.649994  139.839996  142.020004   \n","4     2023-11-10  143.559998  143.559998  143.649994  139.910004  140.460007   \n","..           ...         ...         ...         ...         ...         ...   \n","504   2025-11-10  248.399994  248.399994  251.750000  245.589996  248.339996   \n","505   2025-11-11  249.100006  249.100006  249.750000  247.229996  248.410004   \n","506   2025-11-12  244.199997  244.199997  250.369995  243.750000  250.240005   \n","507   2025-11-13  237.580002  237.580002  243.750000  236.500000  243.050003   \n","508   2025-11-14  234.690002  234.690002  238.729996  232.889999  235.059998   \n","\n","Price    volume   EPS         PE status symbol  5Y_close  10Y_close  \n","0      44970400  7.08  19.737289     OK   AMZN     4.609      4.662  \n","1      53553500  7.08  20.156781     OK   AMZN     4.538      4.571  \n","2      44521700  7.08  20.067797     OK   AMZN     4.522      4.523  \n","3      36235400  7.08  19.858758     OK   AMZN     4.640      4.630  \n","4      49287800  7.08  20.276836     OK   AMZN     4.666      4.628  \n","..          ...   ...        ...    ...    ...       ...        ...  \n","504    36476500  7.08  35.084745     OK   AMZN     3.710      4.110  \n","505    23564100  7.08  35.183617     OK   AMZN     3.719      4.120  \n","506    31190100  7.08  34.491525     OK   AMZN     3.668      4.065  \n","507    41401700  7.08  33.556497     OK   AMZN     3.703      4.112  \n","508    38956700  7.08  33.148305     OK   AMZN     3.735      4.148  \n","\n","[509 rows x 13 columns]\n","Data retrieved: 509 rows\n","Prediction for AMZN: Delta=1.0819, Pred=237.50, Close=219.51\n","\n","--- Processing AAPL ---\n","ok\n","Price       from   Adj Close       close        high         low        open  \\\n","0     2023-11-06  177.319580  179.229996  179.429993  176.210007  176.380005   \n","1     2023-11-07  179.881973  181.820007  182.440002  178.970001  179.179993   \n","2     2023-11-08  180.940567  182.889999  183.449997  181.589996  182.350006   \n","3     2023-11-09  180.465683  182.410004  184.119995  181.809998  182.960007   \n","4     2023-11-10  184.656128  186.399994  186.570007  183.529999  183.970001   \n","..           ...         ...         ...         ...         ...         ...   \n","504   2025-11-10  269.429993  269.429993  273.730011  267.459991  268.959991   \n","505   2025-11-11  275.250000  275.250000  275.910004  269.799988  269.809998   \n","506   2025-11-12  273.470001  273.470001  275.730011  271.700012  275.000000   \n","507   2025-11-13  272.950012  272.950012  276.700012  272.089996  274.109985   \n","508   2025-11-14  272.410004  272.410004  275.959991  269.600006  271.049988   \n","\n","Price    volume   EPS         PE status symbol  5Y_close  10Y_close  \n","0      63841300  7.47  23.993306     OK   AAPL     4.609      4.662  \n","1      70530000  7.47  24.340028     OK   AAPL     4.538      4.571  \n","2      49340300  7.47  24.483266     OK   AAPL     4.522      4.523  \n","3      53763500  7.47  24.419010     OK   AAPL     4.640      4.630  \n","4      66133400  7.47  24.953145     OK   AAPL     4.666      4.628  \n","..          ...   ...        ...    ...    ...       ...        ...  \n","504    41312400  7.47  36.068272     OK   AAPL     3.710      4.110  \n","505    46208300  7.47  36.847390     OK   AAPL     3.719      4.120  \n","506    48398000  7.47  36.609103     OK   AAPL     3.668      4.065  \n","507    49602800  7.47  36.539493     OK   AAPL     3.703      4.112  \n","508    47431300  7.47  36.467203     OK   AAPL     3.735      4.148  \n","\n","[509 rows x 13 columns]\n","Data retrieved: 509 rows\n","Prediction for AAPL: Delta=1.0407, Pred=268.52, Close=258.02\n","\n","--- Processing GOOG ---\n","ok\n","Price       from   Adj Close       close        high         low        open  \\\n","0     2023-11-06  130.556564  131.449997  131.559998  129.929993  130.220001   \n","1     2023-11-07  131.500092  132.399994  133.279999  131.139999  131.979996   \n","2     2023-11-08  132.354248  133.259995  133.539993  132.160004  132.360001   \n","3     2023-11-09  130.794937  131.690002  133.960007  131.509995  133.360001   \n","4     2023-11-10  133.148819  134.059998  134.270004  130.869995  131.529999   \n","..           ...         ...         ...         ...         ...         ...   \n","504   2025-11-10  290.589996  290.589996  291.459991  283.540009  285.265015   \n","505   2025-11-11  291.739990  291.739990  292.339996  287.880005  288.200012   \n","506   2025-11-12  287.429993  287.429993  292.359985  284.380005  292.084991   \n","507   2025-11-13  279.119995  279.119995  283.510010  278.000000  282.984985   \n","508   2025-11-14  276.980011  276.980011  279.149994  271.410004  271.894989   \n","\n","Price    volume    EPS         PE status symbol  5Y_close  10Y_close  \n","0      15360400  10.13  12.976308     OK   GOOG     4.609      4.662  \n","1      19223800  10.13  13.070088     OK   GOOG     4.538      4.571  \n","2      15093600  10.13  13.154985     OK   GOOG     4.522      4.523  \n","3      17976500  10.13  13.000000     OK   GOOG     4.640      4.630  \n","4      20872900  10.13  13.233958     OK   GOOG     4.666      4.628  \n","..          ...    ...        ...    ...    ...       ...        ...  \n","504    19508200  10.13  28.686081     OK   GOOG     3.710      4.110  \n","505    14156700  10.13  28.799604     OK   GOOG     3.719      4.120  \n","506    16998800  10.13  28.374136     OK   GOOG     3.668      4.065  \n","507    18060200  10.13  27.553800     OK   GOOG     3.703      4.112  \n","508    18330500  10.13  27.342548     OK   GOOG     3.735      4.148  \n","\n","[509 rows x 13 columns]\n","Data retrieved: 509 rows\n","Prediction for GOOG: Delta=1.1152, Pred=274.85, Close=246.45\n","\n","--- Processing NDAQ ---\n","ok\n","Price       from  Adj Close      close       high        low       open  \\\n","0     2023-11-06  49.367153  50.730000  51.220001  50.049999  50.099998   \n","1     2023-11-07  49.814789  51.189999  51.580002  50.599998  50.919998   \n","2     2023-11-08  50.350014  51.740002  52.080002  51.200001  51.310001   \n","3     2023-11-09  50.038612  51.419998  52.029999  51.299999  52.000000   \n","4     2023-11-10  50.710075  52.110001  52.250000  51.419998  51.580002   \n","..           ...        ...        ...        ...        ...        ...   \n","504   2025-11-10  87.820000  87.820000  88.300003  86.830002  87.199997   \n","505   2025-11-11  87.830002  87.830002  88.230003  87.699997  87.889999   \n","506   2025-11-12  88.769997  88.769997  89.190002  87.730003  87.830002   \n","507   2025-11-13  87.430000  87.430000  88.599998  87.339996  88.290001   \n","508   2025-11-14  87.080002  87.080002  87.610001  86.139999  87.239998   \n","\n","Price   volume  EPS         PE status symbol  5Y_close  10Y_close  \n","0      2650600  2.8  18.117857     OK   NDAQ     4.609      4.662  \n","1      2258600  2.8  18.282142     OK   NDAQ     4.538      4.571  \n","2      2525100  2.8  18.478572     OK   NDAQ     4.522      4.523  \n","3      2089300  2.8  18.364285     OK   NDAQ     4.640      4.630  \n","4      1846200  2.8  18.610715     OK   NDAQ     4.666      4.628  \n","..         ...  ...        ...    ...    ...       ...        ...  \n","504    2084800  2.8  31.364286     OK   NDAQ     3.710      4.110  \n","505    1493100  2.8  31.367858     OK   NDAQ     3.719      4.120  \n","506    1713100  2.8  31.703570     OK   NDAQ     3.668      4.065  \n","507    1677900  2.8  31.225000     OK   NDAQ     3.703      4.112  \n","508    2542400  2.8  31.100001     OK   NDAQ     3.735      4.148  \n","\n","[509 rows x 13 columns]\n","Data retrieved: 509 rows\n","Prediction for NDAQ: Delta=0.9967, Pred=87.32, Close=87.61\n","\n","--- Processing META ---\n","ok\n","Price       from   Adj Close       close        high         low        open  \\\n","0     2023-11-06  313.865112  315.799988  318.329987  314.450012  315.980011   \n","1     2023-11-07  316.866608  318.820007  321.000000  315.119995  317.059998   \n","2     2023-11-08  317.820770  319.779999  321.329987  314.880005  318.140015   \n","3     2023-11-09  318.586029  320.549988  324.179993  318.799988  319.420013   \n","4     2023-11-10  326.755646  328.769989  329.100006  319.459991  319.940002   \n","..           ...         ...         ...         ...         ...         ...   \n","504   2025-11-10  631.760010  631.760010  635.000000  618.109985  631.090027   \n","505   2025-11-11  627.080017  627.080017  629.559998  619.390015  628.000000   \n","506   2025-11-12  609.010010  609.010010  628.989990  607.770020  628.130005   \n","507   2025-11-13  609.890015  609.890015  617.650024  603.000000  613.070007   \n","508   2025-11-14  609.460022  609.460022  613.679993  595.200012  601.789978   \n","\n","Price    volume    EPS         PE status symbol  5Y_close  10Y_close  \n","0      12887700  22.58  13.985828     OK   META     4.609      4.662  \n","1      14055600  22.58  14.119575     OK   META     4.538      4.571  \n","2      13609700  22.58  14.162090     OK   META     4.522      4.523  \n","3      16103100  22.58  14.196191     OK   META     4.640      4.630  \n","4      19096200  22.58  14.560230     OK   META     4.666      4.628  \n","..          ...    ...        ...    ...    ...       ...        ...  \n","504    19245000  22.58  27.978743     OK   META     3.710      4.110  \n","505    13302200  22.58  27.771480     OK   META     3.719      4.120  \n","506    24493300  22.58  26.971214     OK   META     3.668      4.065  \n","507    20973800  22.58  27.010187     OK   META     3.703      4.112  \n","508    20724100  22.58  26.991144     OK   META     3.735      4.148  \n","\n","[509 rows x 13 columns]\n","Data retrieved: 509 rows\n","Prediction for META: Delta=0.8681, Pred=616.82, Close=710.56\n","\n","--- Processing TSLA ---\n","ok\n","Price       from   Adj Close       close        high         low        open  \\\n","0     2023-11-06  219.270004  219.270004  226.320007  215.000000  223.979996   \n","1     2023-11-07  222.179993  222.179993  223.119995  215.720001  219.979996   \n","2     2023-11-08  222.110001  222.110001  224.149994  217.639999  223.149994   \n","3     2023-11-09  209.979996  209.979996  220.800003  206.679993  219.750000   \n","4     2023-11-10  214.649994  214.649994  215.380005  205.690002  210.029999   \n","..           ...         ...         ...         ...         ...         ...   \n","504   2025-11-10  445.230011  445.230011  449.670013  433.359985  439.600006   \n","505   2025-11-11  439.619995  439.619995  442.489990  432.359985  439.399994   \n","506   2025-11-12  430.600006  430.600006  442.329987  426.559998  442.149994   \n","507   2025-11-13  401.989990  401.989990  424.500000  396.339996  423.130005   \n","508   2025-11-14  404.350006  404.350006  412.190002  382.779999  386.299988   \n","\n","Price     volume   EPS          PE status symbol  5Y_close  10Y_close  \n","0      117335800  1.45  151.220693     OK   TSLA     4.609      4.662  \n","1      116900100  1.45  153.227581     OK   TSLA     4.538      4.571  \n","2      106584800  1.45  153.179311     OK   TSLA     4.522      4.523  \n","3      142110500  1.45  144.813790     OK   TSLA     4.640      4.630  \n","4      130994000  1.45  148.034479     OK   TSLA     4.666      4.628  \n","..           ...   ...         ...    ...    ...       ...        ...  \n","504     76515900  1.45  307.055180     OK   TSLA     3.710      4.110  \n","505     60533200  1.45  303.186204     OK   TSLA     3.719      4.120  \n","506     58513500  1.45  296.965521     OK   TSLA     3.668      4.065  \n","507    118948000  1.45  277.234476     OK   TSLA     3.703      4.112  \n","508    105506700  1.45  278.862073     OK   TSLA     3.735      4.148  \n","\n","[509 rows x 13 columns]\n","Data retrieved: 509 rows\n","Prediction for TSLA: Delta=0.9205, Pred=395.65, Close=429.83\n","\n","--- Processing INTC ---\n","ok\n","Price       from  Adj Close      close       high        low       open  \\\n","0     2023-11-06  37.448456  37.950001  38.200001  37.849998  38.020000   \n","1     2023-11-07  38.257618  38.770000  38.900002  37.980000  38.240002   \n","2     2023-11-08  37.418854  37.919998  38.889999  37.750000  38.849998   \n","3     2023-11-09  37.300442  37.799999  38.520000  37.770000  38.049999   \n","4     2023-11-10  38.346436  38.860001  38.990002  38.240002  38.240002   \n","..           ...        ...        ...        ...        ...        ...   \n","504   2025-11-10  38.450001  38.450001  39.529999  37.970001  38.930000   \n","505   2025-11-11  37.880001  37.880001  38.220001  37.490002  38.150002   \n","506   2025-11-12  37.889999  37.889999  38.200001  37.349998  38.060001   \n","507   2025-11-13  35.910000  35.910000  37.310001  35.450001  37.270000   \n","508   2025-11-14  35.520000  35.520000  36.099998  34.619999  35.029999   \n","\n","Price    volume   EPS          PE status symbol  5Y_close  10Y_close  \n","0      23877200  0.06  632.500013     OK   INTC     4.609      4.662  \n","1      32052000  0.06  646.166674     OK   INTC     4.538      4.571  \n","2      33483400  0.06  631.999969     OK   INTC     4.522      4.523  \n","3      48955800  0.06  629.999987     OK   INTC     4.640      4.630  \n","4      38862500  0.06  647.666677     OK   INTC     4.666      4.628  \n","..          ...   ...         ...    ...    ...       ...        ...  \n","504    77820300  0.06  640.833346     OK   INTC     3.710      4.110  \n","505    53741900  0.06  631.333351     OK   INTC     3.719      4.120  \n","506    53876000  0.06  631.499990     OK   INTC     3.668      4.065  \n","507    95593200  0.06  598.499997     OK   INTC     3.703      4.112  \n","508    71716200  0.06  592.000008     OK   INTC     3.735      4.148  \n","\n","[509 rows x 13 columns]\n","Data retrieved: 509 rows\n","Prediction for INTC: Delta=0.9902, Pred=36.47, Close=36.83\n","\n","--- Processing AMD ---\n","ok\n","Price       from   Adj Close       close        high         low        open  \\\n","0     2023-11-06  111.750000  111.750000  113.080002  110.220001  112.599998   \n","1     2023-11-07  113.449997  113.449997  114.650002  111.220001  111.860001   \n","2     2023-11-08  113.589996  113.589996  115.320000  112.879997  113.550003   \n","3     2023-11-09  113.489998  113.489998  115.809998  113.059998  114.099998   \n","4     2023-11-10  118.589996  118.589996  119.699997  114.029999  114.349998   \n","..           ...         ...         ...         ...         ...         ...   \n","504   2025-11-10  243.979996  243.979996  248.899994  240.500000  242.139999   \n","505   2025-11-11  237.520004  237.520004  248.460007  234.639999  241.660004   \n","506   2025-11-12  258.890015  258.890015  263.510010  250.000000  253.130005   \n","507   2025-11-13  247.960007  247.960007  259.630005  246.059998  251.899994   \n","508   2025-11-14  246.809998  246.809998  253.440002  235.080002  240.110001   \n","\n","Price     volume   EPS          PE status symbol  5Y_close  10Y_close  \n","0       49270400  1.92   58.203125     OK    AMD     4.609      4.662  \n","1       50550200  1.92   59.088540     OK    AMD     4.538      4.571  \n","2       41880600  1.92   59.161456     OK    AMD     4.522      4.523  \n","3       61146900  1.92   59.109374     OK    AMD     4.640      4.630  \n","4       75135900  1.92   61.765623     OK    AMD     4.666      4.628  \n","..           ...   ...         ...    ...    ...       ...        ...  \n","504     43361600  1.92  127.072914     OK    AMD     3.710      4.110  \n","505     61336800  1.92  123.708336     OK    AMD     3.719      4.120  \n","506    108942000  1.92  134.838549     OK    AMD     3.668      4.065  \n","507     63178600  1.92  129.145837     OK    AMD     3.703      4.112  \n","508     47655600  1.92  128.546874     OK    AMD     3.735      4.148  \n","\n","[509 rows x 13 columns]\n","Data retrieved: 509 rows\n","Prediction for AMD: Delta=1.4081, Pred=231.88, Close=164.67\n","\n","--- Execution Complete ---\n","Results saved to output.xlsx for 8 tickers.\n"]}]}],"metadata":{"colab":{"provenance":[{"file_id":"18hc85SqX9Mk4Gu5XN_blgLg7xl3zJgvt","timestamp":1763793716908},{"file_id":"1Rn6rODeGJ0ND88QHnfZXeKZ4w-oe6e5X","timestamp":1763616111684},{"file_id":"15m1lylzlGt_DQfYXhT-rI_8uxqxkgaFm","timestamp":1697958652518}]},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}